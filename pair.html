<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ADEEL-MD Futuristic Pairing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#00ffee" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    :root{
      --neon-1:#00ffee;
      --neon-2:#8a2be2;
      --neon-3:#39ff14;
      --neon-4:#ff00aa;
      --neon-5:#00d1ff;
      --neon-6:#ffdd00;
      --neon-7:#ff4d4d;
      --neon-8:#b6ff00;
      --neon-9:#a020f0;
      --text:#e6fff9;
      --bg:#0a0a0f;
      --glass: rgba(255,255,255,0.06);
      --border: rgba(0,255,238,0.35);
      --shadow: 0 0 18px rgba(0,255,238,0.35), 0 0 36px rgba(138,43,226,0.25);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text);
      background: radial-gradient(1200px 1200px at 10% -10%, rgba(0,255,238,.08), transparent 60%),
                  radial-gradient(1300px 900px at 110% 20%, rgba(138,43,226,.12), transparent 60%),
                  linear-gradient(180deg, #050509, #0a0a12 40%, #050509);
      font-family:'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      overflow:hidden;
    }

    /* Background FX canvas */
    #fx {
      position:fixed; inset:0; z-index:0; pointer-events:none; filter:contrast(130%) saturate(120%);
      animation:huerotate 30s linear infinite;
    }
    @keyframes huerotate { 0%{filter:hue-rotate(0deg)} 100%{filter:hue-rotate(360deg)} }

    /* Layout */
    .wrap{
      position:relative; z-index:1; height:100%; width:100%;
      display:grid; place-items:center; padding:24px;
    }
    .card{
      width:min(95vw,820px);
      background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      border:1px solid var(--border);
      border-radius:20px;
      box-shadow:var(--shadow);
      backdrop-filter: blur(8px);
      padding:28px 24px 24px;
      position:relative;
      overflow:hidden;
    }
    .glow{
      position:absolute; inset:-2px;
      background: conic-gradient(from 0deg, var(--neon-1), var(--neon-2), var(--neon-3), var(--neon-4), var(--neon-5), var(--neon-6), var(--neon-7), var(--neon-8), var(--neon-9), var(--neon-1));
      filter: blur(28px) opacity(.18); z-index:0; animation: spin 12s linear infinite;
    }
    @keyframes spin { to{ transform: rotate(360deg) } }

    /* Header */
    .head{
      position:relative; z-index:1;
      display:flex; align-items:center; gap:14px; justify-content:center;
      margin-bottom:14px; text-align:center;
    }
    .logo{
      width:42px; height:42px; border-radius:12px; display:grid; place-items:center;
      border:1px solid var(--border);
      box-shadow:0 0 12px rgba(0,255,238,.3) inset;
      background: rgba(0,0,0,.35);
    }
    .title{
      font-family:'Orbitron', system-ui; font-weight:700; letter-spacing:.6px;
      text-shadow: 0 0 10px rgba(0,255,238,.5), 0 0 20px rgba(138,43,226,.3);
      font-size: clamp(22px, 3vw, 32px);
    }

    /* Controls */
    .controls{
      position:relative; z-index:1;
      display:grid; grid-template-columns:1fr auto; gap:12px; align-items:center;
      width:min(92vw,680px); margin:0 auto 10px;
    }
    .input{
      background:var(--glass);
      border:1px solid var(--border);
      color:var(--text); border-radius:14px; padding:14px 14px;
      outline:none; font-size:16px; text-align:center;
      transition: box-shadow .25s, border-color .25s, transform .15s;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.3);
    }
    .input:focus{
      border-color:var(--neon-1);
      box-shadow:0 0 0 3px rgba(0,255,238,.18);
      transform: translateY(-1px);
    }
    .btn{
      --bg: var(--neon-1);
      background: linear-gradient(135deg, var(--bg), #0cf);
      color:#001314; font-weight:700; font-family:'Orbitron';
      border:none; border-radius:14px; padding:14px 18px; cursor:pointer;
      box-shadow: 0 8px 22px rgba(0,255,238,.25), inset 0 -2px 0 rgba(0,0,0,.25);
      transition: transform .12s ease, filter .25s ease;
      white-space:nowrap;
    }
    .btn:hover{ transform: translateY(-1px) }
    .btn:active{ transform: translateY(1px) }
    .muter{
      position:fixed; top:14px; right:14px; z-index:5;
      background:rgba(0,0,0,.6); color:var(--neon-1); border:1px solid var(--border);
      border-radius:999px; padding:8px 14px; font-weight:700; font-family:'Orbitron'; cursor:pointer;
      box-shadow:var(--shadow);
    }

    /* Result / Console */
    .console{
      position:relative; z-index:1;
      width:min(92vw,680px); margin:14px auto 0;
      background:linear-gradient(180deg, rgba(0,0,0,.6), rgba(0,0,0,.35));
      border:1px solid var(--border); border-radius:16px; padding:16px 14px;
      min-height:84px;
      box-shadow: inset 0 0 24px rgba(0,255,238,0.06);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    }
    .line{
      display:flex; align-items:flex-start; gap:8px; margin:6px 0; word-break:break-word;
      animation: appear .35s ease both;
    }
    @keyframes appear{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)}}
    .badge{
      padding:2px 8px; border-radius:999px; font-size:12px; font-weight:700; font-family:'Orbitron';
      border:1px solid var(--border); background:rgba(0,0,0,.5); color:var(--neon-1);
      white-space:nowrap; text-shadow:0 0 10px rgba(0,255,238,.35);
    }
    .code{flex:1}

    /* Floating messages (ambient) */
    .ambient{
      position:fixed; inset:0; pointer-events:none; z-index:2;
      font-family:'Orbitron';
    }
    .msg{
      position:absolute; font-size:12px; opacity:0; color:#fff;
      text-shadow: 0 0 8px rgba(255,255,255,.5);
      animation: floatMsg 8s linear forwards;
      filter: drop-shadow(0 0 10px rgba(0,255,238,.6));
    }
    @keyframes floatMsg {
      0% { opacity: 0; transform: translateY(0) }
      10%{ opacity: 1 }
      90%{ opacity: 1; transform: translateY(-140px) }
      100%{ opacity: 0 }
    }

    /* Anime Girl + Speech bubble */
    .ai{
      position:fixed; right:14px; bottom:10px; z-index:3; width:210px; max-width:36vw;
      animation: bob 6s ease-in-out infinite;
      filter: drop-shadow(0 0 18px rgba(0,255,238,.25));
    }
    @keyframes bob{ 0%,100%{ transform:translateY(0) } 50%{ transform:translateY(-14px) } }

    .bubble{
      position:fixed; right:230px; bottom:120px; z-index:3; max-width:min(60vw,380px);
      background: rgba(0,0,0,.65);
      border:1px solid var(--border); border-radius:14px; padding:12px 14px;
      box-shadow: var(--shadow); backdrop-filter: blur(6px);
      font-family:'Inter'; line-height:1.35;
      animation: appear .35s ease both;
    }
    .bubble:after{
      content:""; position:absolute; right:-10px; bottom:12px; width:0; height:0;
      border-left:10px solid var(--border); border-top:8px solid transparent; border-bottom:8px solid transparent; filter:brightness(.9);
    }
    .type{ display:inline-block; border-right:2px solid var(--neon-1); white-space:nowrap; overflow:hidden; }

    /* Mobile tweaks */
    @media (max-width:640px){
      .controls{ grid-template-columns:1fr; }
      .bubble{ right:14px; bottom:170px; max-width:86vw }
      .ai{ right:6px; width:160px }
    }
  </style>
</head>
<body>
  <canvas id="fx"></canvas>

  <button id="mute" class="muter">🔊 SOUND ON</button>

  <div class="wrap">
    <div class="card">
      <div class="glow" aria-hidden="true"></div>
      <div class="head">
        <div class="logo">⚡</div>
        <div class="title">ADEEL-MD • Neon Pairing Console</div>
      </div>

      <div class="controls">
        <input id="number" class="input" placeholder="Enter WhatsApp Number e.g. 923390809008" inputmode="numeric" />
        <button id="pair" class="btn">🚀 Generate Pair Code</button>
      </div>

      <div id="console" class="console" role="log" aria-live="polite"></div>
    </div>
  </div>

  <!-- Anime Girl (inline SVG) -->
  <svg class="ai" viewBox="0 0 200 300" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
    <defs>
      <linearGradient id="hair" x1="0" x2="1">
        <stop offset="0" stop-color="#00ffee"/>
        <stop offset="1" stop-color="#8a2be2"/>
      </linearGradient>
    </defs>
    <circle cx="100" cy="90" r="44" fill="url(#hair)" opacity="0.85"/>
    <ellipse cx="100" cy="160" rx="46" ry="56" fill="#0c1620" opacity="0.8"/>
    <circle cx="85" cy="88" r="6" fill="#fff"/>
    <circle cx="115" cy="88" r="6" fill="#fff"/>
    <circle cx="85" cy="88" r="3" fill="#0cf"/>
    <circle cx="115" cy="88" r="3" fill="#0cf"/>
    <rect x="74" y="108" width="52" height="6" rx="3" fill="#00ffee" opacity="0.8">
      <animate attributeName="opacity" values="0.3;1;0.3" dur="2.4s" repeatCount="indefinite"/>
    </rect>
  </svg>

  <!-- Speech Bubble -->
  <div id="bubble" class="bubble" style="display:none">
    <span id="bubbleText" class="type"></span>
  </div>

  <script>
    /********************
     * SOUND ENGINE
     ********************/
    const sounds = {
      welcome: new Audio('sounds/welcome.mp3'),
      click: new Audio('sounds/click.mp3'),
      error: new Audio('sounds/error.mp3'),
      typing: new Audio('sounds/typing.mp3'),
      idle: new Audio('sounds/idle.mp3'),
      notification: new Audio('sounds/notification.mp3'),
      success: new Audio('sounds/success.mp3'),
      exit: new Audio('sounds/exit.mp3')
    };
    Object.values(sounds).forEach(a => { a.preload = 'auto'; a.volume = 0.9 });

    let muted = false;
    const muteBtn = document.getElementById('mute');
    muteBtn.addEventListener('click', () => {
      muted = !muted;
      muteBtn.textContent = muted ? '🔇 SOUND OFF' : '🔊 SOUND ON';
      if (!muted) play('click');
    });

    function play(name){
      const a = sounds[name];
      if (!a || muted) return;
      try { a.currentTime = 0; a.play(); } catch {}
    }

    /********************
     * AMBIENT FLOATERS
     ********************/
    const ambient = document.createElement('div');
    ambient.className = 'ambient';
    document.body.appendChild(ambient);

    const floatMessages = [
      '⚡ Welcome Janu',
      '🚀 Pairing Engine Active',
      '💫 Neon Protocol Online',
      '🌌 Secure Channel Init',
      '✨ Anime Guide Ready',
      '🛰️ Linking WhatsApp…',
      '🔐 Encrypted Handshake',
      '🧠 Smart Retry Enabled'
    ];
    setInterval(() => {
      const el = document.createElement('div');
      el.className = 'msg';
      el.textContent = floatMessages[Math.floor(Math.random()*floatMessages.length)];
      el.style.left = Math.random()*window.innerWidth + 'px';
      el.style.bottom = (10 + Math.random()*60) + 'px';
      el.style.color = pickNeon();
      ambient.appendChild(el);
      setTimeout(()=> el.remove(), 8000);
    }, 2400);

    function pickNeon(){
      const arr = ['var(--neon-1)','var(--neon-2)','var(--neon-3)','var(--neon-4)','var(--neon-5)','var(--neon-6)','var(--neon-7)','var(--neon-8)','var(--neon-9)'];
      return getComputedStyle(document.documentElement).getPropertyValue(arr[Math.floor(Math.random()*arr.length)]);
    }

    /********************
     * CONSOLE LOGGER
     ********************/
    const consoleBox = document.getElementById('console');
    function logLine(tag, text, tone='info'){
      const line = document.createElement('div');
      line.className = 'line';
      const badge = document.createElement('span');
      badge.className = 'badge';
      badge.textContent = tag;
      badge.style.color = pickNeon();
      const code = document.createElement('div');
      code.className = 'code';
      code.textContent = text;
      line.appendChild(badge); line.appendChild(code);
      consoleBox.appendChild(line);
      consoleBox.scrollTop = consoleBox.scrollHeight;
      if (tone==='ok') play('success');
      else if (tone==='err') play('error');
      else play('typing');
    }

    /********************
     * SPEECH BUBBLE
     ********************/
    const bubble = document.getElementById('bubble');
    const bubbleText = document.getElementById('bubbleText');
    async function say(text, speed=20){
      bubble.style.display = 'block';
      bubbleText.textContent = '';
      play('typing');
      for(let i=0;i<text.length;i++){
        bubbleText.textContent += text[i];
        await new Promise(r=>setTimeout(r, speed));
      }
    }
    function hideBubble(){ bubble.style.display='none' }

    /********************
     * PARTICLE FX
     ********************/
    const c = document.getElementById('fx');
    const ctx = c.getContext('2d', { alpha: true });
    let W,H,particles=[];
    function resize(){ W= c.width = innerWidth; H= c.height = innerHeight }
    addEventListener('resize', resize); resize();

    function spawn(){
      const count = Math.min(120, Math.floor(W*H/15000));
      particles = new Array(count).fill(0).map(()=>({
        x: Math.random()*W,
        y: Math.random()*H,
        r: Math.random()*2 + .6,
        vx: (Math.random()-.5)*.6,
        vy: (Math.random()-.5)*.6,
        h: Math.random()*360
      }));
    }
    spawn();

    function step(){
      ctx.clearRect(0,0,W,H);
      for(const p of particles){
        p.x+=p.vx; p.y+=p.vy;
        if(p.x<0||p.x>W) p.vx*=-1;
        if(p.y<0||p.y>H) p.vy*=-1;
        p.h = (p.h + .4) % 360;
        ctx.beginPath();
        ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
        ctx.fillStyle = `hsla(${p.h},100%,60%,0.8)`;
        ctx.shadowColor = `hsla(${p.h},100%,60%,0.6)`;
        ctx.shadowBlur = 8;
        ctx.fill();
      }
      requestAnimationFrame(step);
    }
    step();

    /********************
     * PAIRING FLOW
     ********************/
    const numberInput = document.getElementById('number');
    const pairBtn = document.getElementById('pair');

    // Welcome
    window.addEventListener('load', async ()=>{
      logLine('SYSTEM', 'Neon UI booted. Ready when you are.');
      await say('Welcome Janu! I am your anime guide. Let’s generate your WhatsApp pairing code.');
      play('welcome');
      setTimeout(()=> play('idle'), 1200);
    });

    pairBtn.addEventListener('click', () => startPair());
    numberInput.addEventListener('keydown', e => { if(e.key==='Enter') startPair() });

    async function startPair(){
      const number = numberInput.value.replace(/\D/g,'').trim();
      if(!number){
        logLine('INPUT', 'Please enter a valid number (e.g., 923390809008).', 'err');
        say('Aray Janu! Number to likho na.'); play('error'); return;
      }

      pairBtn.disabled = true;
      pairBtn.style.opacity = .7;

      logLine('PAIR', `Requesting pairing code for ${number} …`);
      await say('Generating secure pairing code… please wait.');

      try{
        const res = await fetch(`/code?number=${encodeURIComponent(number)}`);
        const data = await res.json();

        if (data.status === 'pairing-started' && data.code){
          logLine('CODE', `Your Pairing Code: ${data.code}`, 'ok');
          say('Code ready! Check the console and use it in WhatsApp.');
          play('notification');
        } else if (data.status === 'connected' && data.code){
          logLine('SESSION', 'Paired successfully. Session ID sent to your WhatsApp.', 'ok');
          logLine('ID', data.code);
          say('Connected! Session delivered to your WhatsApp. Keep it secret.');
          play('success');
        } else if (data.error || data.status === 'error'){
          const msg = data.error || data.message || 'Unknown error';
          logLine('ERROR', msg, 'err');
          say('Oops! Something went wrong, Janu.');
        } else {
          logLine('WARN', 'Unknown response received.', 'err');
          say('Hmm… received an unexpected response.');
        }
      }catch(err){
        logLine('NETWORK', `Failed to get code: ${err.message}`, 'err');
        say('Network issue! Try again in a bit, Janu.');
      }finally{
        pairBtn.disabled = false;
        pairBtn.style.opacity = 1;
      }
    }

    // UX: click sounds
    document.addEventListener('click', (e)=>{
      if (e.target === pairBtn || e.target === muteBtn) return; // already handled
      play('click');
    });

    // Auto ambient bubble hints
    setInterval(()=>{
      if (Math.random() < 0.5) return;
      const hints = [
        'Tip: Keep your session ID private.',
        'Pro: If busy, retry after 30s.',
        'Note: Pairing code expires quickly.',
        'Heads up: Use correct country code.',
        'FYI: Do not share your session.'
      ];
      say(hints[Math.floor(Math.random()*hints.length)], 18);
    }, 12000);
  </script>
</body>
</html>